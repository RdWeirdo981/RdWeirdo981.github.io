<!DOCTYPE html>
<html lang="en">
<head>
	<!--pjax: don't stop the music-->
  <script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script>
  
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:300,300italic,400,400italic,700,700italic|Syne+Mono:300,300italic,400,400italic,700,700italic|Abril+Fatface:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rdweirdo981.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="Cryptography | Mathematics | InfoSec | etc.">
<meta property="og:type" content="website">
<meta property="og:title" content="Life φlosophy">
<meta property="og:url" content="https://rdweirdo981.github.io/page/2/index.html">
<meta property="og:site_name" content="Life φlosophy">
<meta property="og:description" content="Cryptography | Mathematics | InfoSec | etc.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Daisy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://rdweirdo981.github.io/page/2/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>Life φlosophy</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>


<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Life φlosophy</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-collection"><a href="/collection/" rel="section"><i class="fa fa-globe fa-fw"></i>Resources</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
		<iframe src="https://open.spotify.com/embed/track/5Q777K2mEK7lxZHROGIZrt?utm_source=generator" width="100%" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Daisy"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Daisy</p>
  <div class="site-description" itemprop="description">Cryptography | Mathematics | InfoSec | etc.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://rdweirdo981.github.io/2022/10/12/CTF/DUCTF-2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Daisy">
      <meta itemprop="description" content="Cryptography | Mathematics | InfoSec | etc.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Life φlosophy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/10/12/CTF/DUCTF-2022/" class="post-title-link" itemprop="url">Down Under CTF 2022</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-10-12 01:04:11" itemprop="dateCreated datePublished" datetime="2022-10-12T01:04:11+08:00">2022-10-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-10-25 22:50:02" itemprop="dateModified" datetime="2022-10-25T22:50:02+08:00">2022-10-25</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Catch-The-Flag/" itemprop="url" rel="index"><span itemprop="name">Catch The Flag</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Catch-The-Flag/CTF-Crypto/" itemprop="url" rel="index"><span itemprop="name">CTF-Crypto</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="baby-arx">baby arx</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baby_arx</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">64</span></span><br><span class="line">        self.state = <span class="built_in">list</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">b</span>(<span class="params">self</span>):</span></span><br><span class="line">        b1 = self.state[<span class="number">0</span>]</span><br><span class="line">        b2 = self.state[<span class="number">1</span>]</span><br><span class="line">        b1 = (b1 ^ ((b1 &lt;&lt; <span class="number">1</span>) | (b1 &amp; <span class="number">1</span>))) &amp; <span class="number">0xff</span></span><br><span class="line">        b2 = (b2 ^ ((b2 &gt;&gt; <span class="number">5</span>) | (b2 &lt;&lt; <span class="number">3</span>))) &amp; <span class="number">0xff</span></span><br><span class="line">        b = (b1 + b2) % <span class="number">256</span></span><br><span class="line">        self.state = self.state[<span class="number">1</span>:] + [b]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stream</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([self.b() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">'./flag.txt'</span>, <span class="string">'rb'</span>).read().strip()</span><br><span class="line">cipher = baby_arx(FLAG)</span><br><span class="line">out = cipher.stream(<span class="number">64</span>).<span class="built_in">hex</span>()</span><br><span class="line">print(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># cb57ba706aae5f275d6d8941b7c7706fe261b7c74d3384390b691c3d982941ac4931c6a4394a1a7b7a336bc3662fd0edab3ff8b31b96d112a026f93fff07e61b</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="solution">Solution</h3>
<p>When I first looked at this problem, I thought this would be a bit
operation problem which, if you are a applied cryptography engineer, you
should be really familiar with. But this misled me so much that I paid
more time working on this problem.</p>
<p><code>% 256</code> is equivalent to <code>&amp; 255</code>; and
<code>&amp; 0xff</code> means getting the lowest 8 bits. I also tried
lots of bit operation technique such as <code>&amp;1</code> is judging
odd/even, right shift(resp. left shift) are <span class="math inline">\(\lfloor \frac{a}{2^{b}} \rfloor\)</span> (resp.
<span class="math inline">\(a\cdot 2^{b}\)</span>)... and so on. But
they just didn't work.</p>
<p>So at the end of the day, I thought, oh, f--- it, I'd just try z3
solver. And the result just popped up.</p>
<p>In fact, it can be solved by z3 solver, but I think it actually do
have its arithmatical solution. I just didn't find it. Like the answer
by the end:
<code>DUCTF{i_d0nt_th1nk_th4ts_h0w_1t_w0rks_actu4lly_92f45fb961ecf420}</code></p>
<h4 id="code">Code</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ct = <span class="string">"cb57ba706aae5f275d6d8941b7c7706fe261b7c74d3384390b691c3d982941ac4931c6a4394a1a7b7a336bc3662fd0edab3ff8b31b96d112a026f93fff07e61b"</span></span><br><span class="line">streamhex_to_bytes = <span class="built_in">bytes</span>.fromhex(ct)</span><br><span class="line">stream_list_back = <span class="built_in">list</span>(streamhex_to_bytes)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line">result = [BitVec(<span class="string">'x{}'</span>.<span class="built_in">format</span>(i), <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>):</span><br><span class="line">    solver.add((((result[i] ^ ((result[i] &lt;&lt; <span class="number">1</span>) | (result[i] &amp; <span class="number">1</span>))) &amp; <span class="number">0xff</span>)</span><br><span class="line">    +((result[i+<span class="number">1</span>] ^ ((result[i+<span class="number">1</span>] &gt;&gt; <span class="number">5</span>) | (result[i+<span class="number">1</span>] &lt;&lt; <span class="number">3</span>))) &amp; <span class="number">0xff</span>))</span><br><span class="line">     % <span class="number">256</span> == stream_list_back[i])</span><br><span class="line"></span><br><span class="line">solver.add((((result[<span class="number">63</span>] ^ ((result[<span class="number">63</span>] &lt;&lt; <span class="number">1</span>) | (result[<span class="number">63</span>] &amp; <span class="number">1</span>))) &amp; <span class="number">0xff</span>)</span><br><span class="line">+((stream_list_back[<span class="number">0</span>] ^ ((stream_list_back[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) | (stream_list_back[<span class="number">0</span>] &lt;&lt; <span class="number">3</span>))) &amp; <span class="number">0xff</span>))</span><br><span class="line">    % <span class="number">256</span> == stream_list_back[<span class="number">63</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> solver.check() == sat:</span><br><span class="line">    recover = solver.model()</span><br><span class="line">    recover_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        recover_list.append(recover[result[i]].as_long())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="built_in">bytes</span>(recover_list).decode())</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="ofb">OFB</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom, path</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(path.join(path.dirname(__file__), <span class="string">'flag.txt'</span>), <span class="string">'r'</span>).read().strip()</span><br><span class="line">MESSAGE = <span class="string">f'Decrypt this... <span class="subst">{urandom(<span class="number">300</span>).<span class="built_in">hex</span>()}</span> <span class="subst">{FLAG}</span>'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    key = urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        iv = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">'iv: '</span>))</span><br><span class="line">        aes = AES.new(key, iv=iv, mode=AES.MODE_OFB)</span><br><span class="line">        ct = aes.encrypt(MESSAGE.encode())</span><br><span class="line">        print(ct.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>
<h3 id="solution-1">solution</h3>
<p>I really enjoyed this one because I didn't refer any previous
solution, and I didn't play block cipher type problem before. I solved
it by my own. But being a cryptography engineer, you always deal with
those block cipher, so this problem is not only meaningful for obtaining
some points in a CTF game, but also helped me understand how to avoid
unsafely implementing cryptography algorithm. (Although I always have a
fear that I might implement something wrong. It's inevitable. That's why
it's also important to add security check for cryptography
implementation in code review.)</p>
<p>Anyway, it's crystal clear that OFB will be vulnerable when you use
the key twice. Because you can always have this so-called "bit-flipped"
attack (I think I read it somewhere else, but can't remember).</p>
<p>The attack for this problem can be summarized by this photo below:
<img src="/2022/10/12/CTF/DUCTF-2022/2.jpg"></p>
<h4 id="code-1">Code</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom, path</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">f'ABCDEFGHIJK<span class="subst">{urandom(<span class="number">67</span>).<span class="built_in">hex</span>()}</span>'</span></span><br><span class="line">MESSAGE = <span class="string">f'Decrypt this... <span class="subst">{urandom(<span class="number">300</span>).<span class="built_in">hex</span>()}</span> <span class="subst">{FLAG}</span>'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    ct_list = []</span><br><span class="line">    </span><br><span class="line">    ct1 = <span class="string">"75d0e05886a8dbd5631162ffc172b054d9b986115b46e81ee741873b429b363d4e6ef9615ca1a831a681f14289d79c69a08656c6b382319c7a2b6f53591890b21c5e146f1ccf5a84d8c21e8c0d8f6cf4b5cdefaa92d0f073588e05650384e1453d1d357e77c81f31f3cde44dad95a3b86098f8d0237f72490347ed5288d4d7f2fd9b9ef09ec24ef93f332267931f7070a806b5943c4e9e74282adfb756a9c9a67277c4f83555c389d8443bc57ccc3a569facc51b6164709a533b3184f4c0a3faacd6a0b694e0ada63749a911dbc840b0fb1b589b87e7a3e12b1109c138ad1eb23287b3e99763bff1c9a4c9eac40b6bab53d5281cf328a0ddc16ed53879f2ac7c831fc8f061889da96a032a5127a2315341ddf6908fc9d3f682ac22d1b176586ce72a92fe55fbef153caaf758151554b98ac7aec86314c3f34eadcdc0fe5c8710f6ddf7bcb023535034485ca66b729d53ba5d6fe85551c87547e9c69eb3e2c2a33320adea7dd9ccec6775a82580f3e53251f1c8a0cb7bfd0d12e2ce931d03bb7736807e7268d8957fbbfae0041b2e4258d0c2669919dd180cab1364f9e04b442aaa7772bd7200f1eab6883eac54e2650252ec0c6056414607d04d97abf517c016e2d2d0b10df0f80e5aafb79bee9721efbb195efcf38ffaf9b9e31eef6f97841b79275823df2ea429808ff15b27d017cc9bce7d9e1479a95919ce680706c22807507abb5e05ca865413922cf3f0d0306aacd5201b84a4a989f0129a3a566528d4cb9b81e17d6f21f3a979a7412b4798a20125d47da3e09232407fa2106f384a5763e8be30acf29d7b09973d2888db7c1fac3ed8ee85aea85342ff3a54ea4d8a7813d4ffb2fe918f6cbc15f4741c46cfd036b34cbad0a09e07a4747635238ad8a38326298bca3790e52775b6e9e31b10a51ac4e9e1da659e98c5e3e6ce606b5e8e8309fe91ebb3cd742baebb0ca4df1fd29edb53c71277f018f92989633aa73112c97bc9c3122b60ef61176736d51bc59c61b4949d6f13c769fbc2e9f4fe93d5ed77d12fbb6b8e966b0de18ff2ba37ed4b5fb3601f95bcd8888eee"</span></span><br><span class="line">    ct1_bytes = <span class="built_in">bytes</span>.fromhex(ct1)</span><br><span class="line">    ct2 = <span class="string">"a5b9d5554601f95da210de7b09d120781532f9340caefe63a688f742db849d3cf38e079ce48d3ace2a7d3f555b179fb71c0943371acd03d4d89c4e8159d53ba7b4cfebfec0d2f2765a83503f0384e515681a3f7d78c84b3ef2cdb717f8c0a0bf66c2f484792d21165542eb528dda86f2f9c79ea4cbc21faf39612d6cc7137e76f653e3c36d1ecd7d2f29d2b751a8c2a22f7ec0f8625692848e143ec729cd3e539ca6924b6661269a563b30d4f793a6fda9dda7e491b7aea36419aa43d8cd40e2fa120fc083b1a4e929440fca6dfb1cb562d3b1b39635ebfb98a3cdb4950a6fab51832d1cf47af48b9e3cdd6f29a7ac7ad14997a161dbcbf86b5a750126f436574180fbc1dfcf85f58cf52587b2205b6ebc259eab07fdeb1038aeaf0d124604b984c6f5ca361597a548fccd93ae5fd24ca28fa7ecb7735051644e04ae3e26cb09ed5f64ee0452c67311ba94c5e1e596f33123a1ba2edbccea6623a324d4a5e73751f6c5f5907ea65845ecc2c31b03ed2161d17123638c9077ebf3b70e4d2a120a82c1619b128b4a52fe1436f5e01d152aa97e7abb7203f1bae6863cac59b0650457e156675b4342068542c2fdf945c212b5dfd6b359f0fe5c0cabe79dbb9775bde01958f9f0dfa8adb9b51fbd36c0801b237d5a76db2bf62f82dea3087a8014cc99997f9c1728ab0c1f993f5407927c55547de85902cf820017932bf3f5873068f084234187f3fa8ea6439a68563b7683c5cbd0bd243321f7fc7ea3457d1993a70271857afeedc063132ba4176d6d4e0332baba33aca09d270e923e28dcd17d1cf06cdabd86ffab0916af6a06e942852b1ed0afe5ad918d68ad65c5032a368d8564b376b290a2da3eb053570343a0cfeaba3702d2d166bbdc23649dacb50115ec30c4f1aceb67f58b99a6c0a1607107dd9d25f1d9c4bdca7318f4f237f5ec1fd7aab440c5107ef45b962ae6306bc16216a27b8a95587964ec324000318317909c64b3c6c86741963fadcae1f0f3c581b774d679be63de973d0fe4d9a5e166bc400bb0361e9ee9dd8ed8a73a88952d5764cc74fedfec9b29ad0886"</span></span><br><span class="line">    ct2_bytes = <span class="built_in">bytes</span>.fromhex(ct2)</span><br><span class="line">    ct_list.append(ct1_bytes)</span><br><span class="line">    ct_list.append(ct2_bytes)</span><br><span class="line"></span><br><span class="line">    enc_list = [<span class="string">"31b5832affd8aff517790b8cef5c9e74"</span>]</span><br><span class="line">    pt1 = <span class="string">'Decrypt this... '</span></span><br><span class="line">    pt_list = [pt1]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">47</span>):</span><br><span class="line"></span><br><span class="line">        ct2_cur = ct_list[<span class="number">1</span>][i*<span class="number">16</span>:(i+<span class="number">1</span>)*<span class="number">16</span>]</span><br><span class="line">        pt_cur = pt_list[i].encode()</span><br><span class="line">        enc2_cur = <span class="built_in">bytes</span>(<span class="built_in">map</span>(xor, ct2_cur, pt_cur))</span><br><span class="line">        enc_list.append(enc2_cur)</span><br><span class="line"></span><br><span class="line">        ct1_next = ct_list[<span class="number">0</span>][(i+<span class="number">1</span>)*<span class="number">16</span>:(i+<span class="number">2</span>)*<span class="number">16</span>]</span><br><span class="line">        pt_next = <span class="built_in">bytes</span>(<span class="built_in">map</span>(xor, ct1_next, enc2_cur)).decode()</span><br><span class="line">        pt_list.append(pt_next)</span><br><span class="line"></span><br><span class="line">    print(pt_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>
<h4 id="result">Result</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'Decrypt this... '</span>, <span class="string">'8e06d7ec1903ed8e'</span>, <span class="string">'c90c483110637790'</span>, <span class="string">'01a9c78caff55865'</span>, <span class="string">'0f6ae5a3a868abaf'</span>, <span class="string">'1d2577c6c5cbabe6'</span>, <span class="string">'dc868779b50847f1'</span>, <span class="string">'b94bbedf40681971'</span>, <span class="string">'fe467e502b93e597'</span>, <span class="string">'80baf5f95a43b423'</span>, <span class="string">'e9fa1674c1117566'</span>, <span class="string">'f31163a4f10a4f31'</span>, <span class="string">'c86c3db15a337c3c'</span>, <span class="string">'b1a872e97458b51d'</span>, <span class="string">'2ecb6d13f31f345d'</span>, <span class="string">'03fb16ee9a91ca5b'</span>, <span class="string">'be931e3488fab72f'</span>, <span class="string">'b84bace76aa7aa1d'</span>, <span class="string">'97873ea22e9bf2ad'</span>, <span class="string">'76c5fd5d44916148'</span>, <span class="string">'cd3ea46ed2a9cebb'</span>, <span class="string">'4f8c078c2a3b1b62'</span>, <span class="string">'6e43c58e378ce447'</span>, <span class="string">'6b9f80c0d943c4ba'</span>, <span class="string">'a3673df840c95023'</span>, <span class="string">'3015824fa7155fc3'</span>, <span class="string">'09938146193584c5'</span>, <span class="string">'54c45307d6fc4fa1'</span>, <span class="string">'b9e6a36e226eaf5c'</span>, <span class="string">'99c3bcd12d77811c'</span>, <span class="string">'ccafff6705edea2c'</span>, <span class="string">'a4cde74b6b27d1f1'</span>, <span class="string">'e30cb2062c57aff3'</span>, <span class="string">'9b39aec1d25ea88d'</span>, <span class="string">'72be89c5151a7f3a'</span>, <span class="string">'4f3be41dba7f5375'</span>, <span class="string">'e47aef18ed4fa966'</span>, <span class="string">'9f52f72b14d4b69e'</span>, <span class="string">'4bee570f DUCTF{0'</span>, <span class="string">'fb_mu5t_4ctu4lly'</span>, <span class="string">'_st4nd_f0r_0bvi0'</span>, <span class="string">'usly_f4ul7y_bl0c'</span>, <span class="string">'k_c1ph3r_m0d3_0f'</span>, <span class="string">'_0p3ra710n_7b9cb'</span>, <span class="string">'403e8332c980456b'</span>, <span class="string">'17a00abd51049cb8'</span>, <span class="string">'207581c274fcb233'</span>, <span class="string">'f3a43df4a}'</span>]</span><br></pre></td></tr></tbody></table></figure>
<h2 id="crt">CRT</h2>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">55899879511190230528616866117179357211</span></span><br><span class="line">V = GF(p)^<span class="number">3</span></span><br><span class="line">R = PolynomialRing(GF(p))</span><br><span class="line">x = R.gen()</span><br><span class="line">f = x^<span class="number">3</span> + <span class="number">36174005300402816514311230770140802253</span>*x^<span class="number">2</span> + <span class="number">35632245244482815363927956306821829684</span>*x + <span class="number">10704085182912790916669912997954900147</span></span><br><span class="line">Q = R.quotient(f)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">V_pow</span>(<span class="params">A, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> V([a^n <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">list</span>(A)])</span><br><span class="line"></span><br><span class="line">n, m = randint(<span class="number">1</span>, p), randint(<span class="number">1</span>, p)</span><br><span class="line">A = Q.random_element()</span><br><span class="line">B = Q.random_element()</span><br><span class="line">C = A^n * B^m</span><br><span class="line"></span><br><span class="line">print(<span class="string">' '</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, <span class="built_in">list</span>(A))))</span><br><span class="line">print(<span class="string">' '</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, <span class="built_in">list</span>(B))))</span><br><span class="line">print(<span class="string">' '</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, <span class="built_in">list</span>(C))))</span><br><span class="line"></span><br><span class="line">phi_A = V(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())))</span><br><span class="line">phi_B = V(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())))</span><br><span class="line">phi_C = V(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())))</span><br><span class="line"></span><br><span class="line">check_phi_C = V_pow(phi_A, n).pairwise_product(V_pow(phi_B, m))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> phi_C == check_phi_C:</span><br><span class="line">    print(<span class="built_in">open</span>(<span class="string">'./flag.txt'</span>, <span class="string">'r'</span>).read().strip())</span><br></pre></td></tr></tbody></table></figure>
<h3 id="solution-2">solution</h3>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Daisy</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>


  <script src='https://unpkg.com/mermaid@/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({theme: 'forest'});
    }
  </script>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  





<script data-pjax>
if (document.querySelectorAll('.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'dark',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>


  




    <div class="pjax">

  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




    </div>
</body>
</html>
